---
- name: APLICANDO PARÁMETROS DEL KERNEL VALORES '0'
  sysctl:
    name: "{{ item }}"
    value: '0'
    state: present
    sysctl_file: /etc/sysctl.conf 
    reload: true
    sysctl_set: yes
  loop: 
    - net.ipv4.conf.all.send_redirects
    - net.ipv4.conf.all.accept_redirects
    - net.ipv4.conf.default.accept_redirects
    - net.ipv4.conf.default.send_redirects
    - net.ipv4.conf.default.secure_redirects
    - net.ipv4.conf.all.secure_redirects
    - net.ipv4.conf.all.accept_source_route
    - net.ipv4.conf.default.accept_source_route
    - net.ipv4.conf.default.rp_filter
    - net.ipv6.conf.default.accept_source_route
    - net.ipv6.conf.all.accept_source_route
    - net.ipv6.conf.all.accept_redirects
    - net.ipv6.conf.default.accept_ra
    - net.ipv6.conf.all.accept_ra
    - net.ipv6.conf.default.accept_redirects
    - fs.suid_dumpable
    - dev.tty.ldisc_autoload
    - kernel.sysrq

- name: APLICANDO PARÁMETROS DEL KERNEL VALORES '1'
  sysctl:
    name: "{{ item }}"
    value: '1'
    state: present
    sysctl_file: /etc/sysctl.conf
    reload: true
    sysctl_set: yes
  loop:
    - net.ipv4.conf.default.log_martians
    - net.ipv4.icmp_ignore_bogus_error_responses
    - net.ipv4.icmp_echo_ignore_broadcasts
    - net.ipv4.tcp_syncookies  
    - kernel.dmesg_restrict
    - kernel.modules_disabled
    - net.ipv4.conf.all.log_martians

- name: APLICANDO PARÁMETROS DEL KERNEL VALORES '2'
  sysctl:
    name: "{{ item }}"
    value: '2'
    state: present
    sysctl_file: /etc/sysctl.conf
    reload: true
    sysctl_set: yes
  loop:
    - fs.protected_fifos
    - fs.protected_regular
    - kernel.kptr_restrict
    - kernel.yama.ptrace_scope
    - net.core.bpf_jit_harden

- name: APLICANDO PARÁMETROS DEL KERNEL VALORES '3'
  sysctl:
    name: "{{ item }}"
    value: '3'
    state: present
    sysctl_file: /etc/sysctl.conf
    reload: true
    sysctl_set: yes
  loop:
    - kernel.perf_event_paranoid